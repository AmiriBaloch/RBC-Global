<!doctype html>
<html lang="en" style="background-color: #E3EBF2;">
  <head>
    <meta charset="UTF-8" />
    <!-- Google Tag Manager -->
    <script>
      // Initialize dataLayer first
      window.dataLayer = window.dataLayer || [];
      
      // Helper function to trigger debug info
      function trackGTMEvent(eventName, data) {
        if (window.dataLayer) {
          try {
            // Add unique identifier to every GTM event
            const uniqueId = Date.now() + '-' + Math.floor(Math.random() * 1000000);
            const eventData = {
              ...data,
              eventId: uniqueId,
              timestamp: new Date().getTime()
            };
            
            // Push to dataLayer
            window.dataLayer.push(eventData);
            console.log('GTM event pushed:', eventName, eventData);
            return true;
          } catch (error) {
            console.error('GTM event error:', error);
            return false;
          }
        }
        return false;
      }
      
      // GTM error handling
      function gtmHasLoaded() {
        console.log('GTM successfully loaded');
        
        // Standard GA4 page_view event
        window.dataLayer.push({
          event: 'page_view',
          page_location: window.location.href,
          page_path: window.location.pathname,
          page_title: 'RBC Global',
          send_to: 'GTM-MLHJMJ7M'
        });
        
        // Force new pageview on successful GTM load
        trackGTMEvent('initialPageview', {
          event: 'initialPageview',
          virtualPageURL: window.location.pathname,
          virtualPageTitle: 'RBC Global',
          'gtm.uniqueEventId': Math.floor(Math.random() * 1000000000),
          page: {
            path: window.location.pathname,
            title: 'RBC Global',
            referrer: document.referrer,
            host: window.location.hostname
          }
        });
      }
      
      // Define dataLayer.push before GTM loads
      trackGTMEvent('virtualPageview', {
        event: 'virtualPageview',
        virtualPageURL: window.location.pathname,
        virtualPageTitle: 'RBC Global',
        'gtm.uniqueEventId': Math.floor(Math.random() * 1000000000),
        page: {
          path: window.location.pathname,
          title: 'RBC Global',
          referrer: document.referrer,
          host: window.location.hostname
        }
      });
      
      // GTM standard code with proper error handler
      (function(w,d,s,l,i){
        w[l]=w[l]||[];
        w[l].push({'gtm.start': new Date().getTime(), event:'gtm.js', 'gtm.uniqueEventId': 1});
        var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
        j.onload = gtmHasLoaded;
        j.onerror = function() { console.error('Failed to load GTM'); };
        f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MLHJMJ7M');
    </script>
    <!-- End Google Tag Manager -->
    <link rel="icon" type="image/png" href="/src/assets/logo3.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Professional consulting services by RBC Global" />
    <meta name="theme-color" content="#2E8B57" />
    <meta property="og:title" content="RBC Global" />
    <meta property="og:description" content="Professional consulting services by RBC Global" />
    <meta property="og:type" content="website" />
    <meta name="twitter:title" content="RBC Global" />
    <meta name="twitter:description" content="Professional consulting services by RBC Global" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Raleway:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <title>RBC Global</title>
  </head>
  <body style="background-color: #E3EBF2;">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MLHJMJ7M"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
